<!DOCTYPE html>
<!-- saved from url=(0257)http://s891234.weebly.com/ajax/apps/generateMap.php?map=google&elementid=756727456536470566&ineditor=0&control=3&width=auto&height=250px&overviewmap=0&scalecontrol=0&typecontrol=0&zoom=15&long=-122.418333&lat=37.775&domain=www&point=1&align=1&reseller=false -->
<html __fvdsurfcanyoninserted="1">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <link type="text/css" rel="stylesheet" href="map/css(7)">
    <style type="text/css">
        .gm-style .gm-style-cc span,
        .gm-style .gm-style-cc a,
        .gm-style .gm-style-mtc div {
            font-size: 10px
        }
    </style>
    <style type="text/css">
        @media print {
            .gm-style .gmnoprint,
            .gmnoprint {
                display: none
            }
        }
        
        @media screen {
            .gm-style .gmnoscreen,
            .gmnoscreen {
                display: none
            }
        }
    </style>
    <style type="text/css">
        .gm-style {
            font-family: Roboto, Arial, sans-serif;
            font-size: 11px;
            font-weight: 400;
            text-decoration: none
        }
        
        .gm-style img {
            max-width: none
        }
    </style>
    <title>Google Maps Output</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <style>
        html,
        body,
        #mapContainer {
            margin: 0;
            padding: 0;
            height: 100%;
        }
        
        #mapContainer {
            width: 100%;
            text-align: center;
        }
        
        a {
            color: #06C;
            text-decoration: none;
        }
        
        a:visited {
            color: #06C;
        }
    </style>
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?v=3"></script>
    <script type="text/javascript">
        //<![CDATA[
        // send a cross domain iframe mesage to the parent to resize the frame to this height
        var resizeMessage = function (event) {
            var imageHeight = document.getElementById('mapContainer').clientHeight;
            window.parent.postMessage(imageHeight, '*');
        };

        function gLoad() {
            var touchSupported = (('ontouchstart' in window) || window.DocumentTouch && document instanceof DocumentTouch)
                , forceTouch = false;
            var myLatLng = new google.maps.LatLng(25.0171071, 121.5409212);
            var mapOptions = {
                scrollwheel: false
                , center: myLatLng
                , zoom: 15
                , panControl: false
                , zoomControl: true
                , zoomControlOptions: {
                    style: google.maps.ZoomControlStyle.SMALL
                }
                , overviewMapControl: false
                , scaleControl: false
                , mapTypeControl: false
                , streetViewControl: false
                , mapTypeId: google.maps.MapTypeId.ROADMAP
            };
            if (touchSupported || forceTouch) {
                mapOptions.draggable = false;
                mapOptions.panControl = false;
                mapOptions.scrollwheel = false;
                mapOptions.zoomControlOptions = {
                    style: google.maps.ZoomControlStyle.SMALL
                };
                mapOptions.zoomControl = true;
            }
            // Use pre-v3.22 controls until the element can be updated with options for the new controls
            google.maps.controlStyle = 'azteca';
            var map = new google.maps.Map(document.getElementById("map"), mapOptions);
            var point = new google.maps.Marker({
                position: myLatLng
                , map: map
            });
            // Maps loaded hidden (like in an accordion) don't center property as their width is often detected as 0.
            // Detect when the iFrame "resizes" and reset the center
            google.maps.event.addDomListener(window, 'resize', function () {
                google.maps.event.trigger(map, 'resize');
                map.setCenter(myLatLng);
            });
        }
        //]]>
    </script>
    <script type="text/javascript" charset="UTF-8" src="map/common.js"></script>
    <script type="text/javascript" charset="UTF-8" src="map/map.js"></script>
    <script type="text/javascript" charset="UTF-8" src="map/util.js"></script>
    <script type="text/javascript" charset="UTF-8" src="map/marker.js"></script>
    <script type="text/javascript" charset="UTF-8" src="map/onion.js"></script>
    <script type="text/javascript" charset="UTF-8" src="map/stats.js"></script>
    <script type="text/javascript" charset="UTF-8" src="map/controls.js"></script>
</head>

<body onload="gLoad();" style="margin: 0; padding: 0;">
    <div id="mapContainer">
        <div id="map" style="height: 250px; max-width: 100%; position: relative; overflow: hidden;">
            <div style="height: 100%; width: 100%; position: absolute; background-color: rgb(229, 227, 223);">
                <div class="gm-style" style="position: absolute; left: 0px; top: 0px; overflow: hidden; width: 100%; height: 100%; z-index: 0;">
                    <div style="position: absolute; left: 0px; top: 0px; overflow: hidden; width: 100%; height: 100%; z-index: 0; cursor: url(&quot;https://maps.gstatic.com/mapfiles/openhand_8_8.cur&quot;) 8 8, default;">
                        <div style="position: absolute; left: 0px; top: 0px; z-index: 1; width: 100%; transform-origin: 0px 0px 0px; transform: matrix(1, 0, 0, 1, 8, 68);">
                            <div style="position: absolute; left: 0px; top: 0px; z-index: 100; width: 100%;">
                                <div style="position: absolute; left: 0px; top: 0px; z-index: 0;">
                                    <div aria-hidden="true" style="position: absolute; left: 0px; top: 0px; z-index: 1; visibility: inherit;">
                                        <div style="width: 256px; height: 256px; position: absolute; left: -124px; top: -5px;"></div>
                                        <div style="width: 256px; height: 256px; position: absolute; left: 132px; top: -5px;"></div>
                                        <div style="width: 256px; height: 256px; position: absolute; left: 132px; top: -261px;"></div>
                                        <div style="width: 256px; height: 256px; position: absolute; left: -124px; top: -261px;"></div>
                                    </div>
                                </div>
                            </div>
                            <div style="position: absolute; left: 0px; top: 0px; z-index: 101; width: 100%;"></div>
                            <div style="position: absolute; left: 0px; top: 0px; z-index: 102; width: 100%;"></div>
                            <div style="position: absolute; left: 0px; top: 0px; z-index: 103; width: 100%;">
                                <div style="position: absolute; left: 0px; top: 0px; z-index: -1;">
                                    <div aria-hidden="true" style="position: absolute; left: 0px; top: 0px; z-index: 1; visibility: inherit;">
                                        <div style="width: 256px; height: 256px; overflow: hidden; position: absolute; left: -124px; top: -5px;"></div>
                                        <div style="width: 256px; height: 256px; overflow: hidden; position: absolute; left: 132px; top: -5px;">
                                            <canvas draggable="false" height="320" width="320" style="user-select: none; position: absolute; left: 0px; top: 0px; height: 256px; width: 256px;"></canvas>
                                        </div>
                                        <div style="width: 256px; height: 256px; overflow: hidden; position: absolute; left: 132px; top: -261px;"></div>
                                        <div style="width: 256px; height: 256px; overflow: hidden; position: absolute; left: -124px; top: -261px;"></div>
                                    </div>
                                </div>
                            </div>
                            <div style="position: absolute; z-index: 0; left: 0px; top: 0px;">
                                <div style="overflow: hidden; width: 372px; height: 250px;"><img src="map/ori_map.png" style="width: 372px; height: 250px;"></div>
                            </div>
<!--
                            <div style="position: absolute; left: 0px; top: 0px; z-index: 0;">
                                <div aria-hidden="true" style="position: absolute; left: 0px; top: 0px; z-index: 1; visibility: inherit;">
                                    <div style="position: absolute; left: -124px; top: -5px; transition: opacity 200ms ease-out;"><img src="./vt(1)" draggable="false" alt="" style="width: 256px; height: 256px; user-select: none; border: 0px; padding: 0px; margin: 0px; max-width: none;"></div>
                                    <div style="position: absolute; left: 132px; top: -5px; transition: opacity 200ms ease-out;"><img src="./vt(2)" draggable="false" alt="" style="width: 256px; height: 256px; user-select: none; border: 0px; padding: 0px; margin: 0px; max-width: none;"></div>
                                    <div style="position: absolute; left: 132px; top: -261px;"><img src="./vt(3)" draggable="false" alt="" style="width: 256px; height: 256px; user-select: none; border: 0px; padding: 0px; margin: 0px; max-width: none;"></div>
                                    <div style="position: absolute; left: -124px; top: -261px;"><img src="./vt(4)" draggable="false" alt="" style="width: 256px; height: 256px; user-select: none; border: 0px; padding: 0px; margin: 0px; max-width: none;"></div>
                                </div>
                            </div>
-->
                        </div>
                        <div style="position: absolute; left: 0px; top: 0px; z-index: 2; width: 100%; height: 100%;"></div>
                        <div style="position: absolute; left: 0px; top: 0px; z-index: 3; width: 100%; height: 100%;"></div>
                        <div style="position: absolute; left: 0px; top: 0px; z-index: 4; width: 100%; transform-origin: 0px 0px 0px; transform: matrix(1, 0, 0, 1, 8, 68);">
                            <div style="position: absolute; left: 0px; top: 0px; z-index: 104; width: 100%;"></div>
                            <div style="position: absolute; left: 0px; top: 0px; z-index: 105; width: 100%;"></div>
                            <div style="position: absolute; left: 0px; top: 0px; z-index: 106; width: 100%;"></div>
                            <div style="position: absolute; left: 0px; top: 0px; z-index: 107; width: 100%;"></div>
                        </div>
                    </div>
                    <div style="margin-left: 5px; margin-right: 5px; z-index: 1000000; position: absolute; left: 0px; bottom: 0px;">
                        <a target="_blank" href="https://www.google.com/maps/place/%E5%9C%8B%E7%AB%8B%E5%8F%B0%E7%81%A3%E5%A4%A7%E5%AD%B8%E7%94%9F%E7%89%A9%E8%B3%87%E6%BA%90%E6%9A%A8%E8%BE%B2%E5%AD%B8%E9%99%A2%E8%BE%B2%E6%A9%9F%E7%B3%BB/@25.017686,121.5407253,17z/data=!3m1!4b1!4m5!3m4!1s0x3442aa2429043393:0xcfa54254447302e2!8m2!3d25.017686!4d121.542914" title="按一下即可查看「Google 地圖」上的這個區域" style="position: static; overflow: visible; float: none; display: inline;">
                            <div style="width: 66px; height: 26px; cursor: pointer;"><img src="map/google4_hdpi.png" draggable="false" style="position: absolute; left: 0px; top: 0px; width: 66px; height: 26px; user-select: none; border: 0px; padding: 0px; margin: 0px;"></div>
                        </a>
                    </div>
                    <div style="background-color: white; padding: 15px 21px; border: 1px solid rgb(171, 171, 171); font-family: Roboto, Arial, sans-serif; color: rgb(34, 34, 34); box-shadow: rgba(0, 0, 0, 0.2) 0px 4px 16px; z-index: 10000002; display: none; width: 256px; height: 148px; position: absolute; left: 36px; top: 35px;">
                        <div style="padding: 0px 0px 10px; font-size: 16px;">地圖資料</div>
                        <div style="font-size: 13px;">地圖資料©2016 Google</div>
                        <div style="width: 13px; height: 13px; overflow: hidden; position: absolute; opacity: 0.7; right: 12px; top: 12px; z-index: 10000; cursor: pointer;"><img src="map/mapcnt6.png" draggable="false" style="position: absolute; left: -2px; top: -336px; width: 59px; height: 492px; user-select: none; border: 0px; padding: 0px; margin: 0px; max-width: none;"></div>
                    </div>
                    <div class="gmnoprint" style="z-index: 1000001; position: absolute; right: 128px; bottom: 0px; width: 118px;">
                        <div draggable="false" class="gm-style-cc" style="user-select: none; height: 14px; line-height: 14px;">
                            <div style="opacity: 0.7; width: 100%; height: 100%; position: absolute;">
                                <div style="width: 1px;"></div>
                                <div style="background-color: rgb(245, 245, 245); width: auto; height: 100%; margin-left: 1px;"></div>
                            </div>
                            <div style="position: relative; padding-right: 6px; padding-left: 6px; font-family: Roboto, Arial, sans-serif; font-size: 10px; color: rgb(68, 68, 68); white-space: nowrap; direction: ltr; text-align: right; vertical-align: middle; display: inline-block;"><a style="color: rgb(68, 68, 68); text-decoration: none; cursor: pointer; display: none;">地圖資料</a><span>地圖資料©2016 Google</span></div>
                        </div>
                    </div>
                    <div class="gmnoscreen" style="position: absolute; right: 0px; bottom: 0px;">
                        <div style="font-family: Roboto, Arial, sans-serif; font-size: 11px; color: rgb(68, 68, 68); direction: ltr; text-align: right; background-color: rgb(245, 245, 245);">地圖資料©2016 Google</div>
                    </div>
                    <div class="gmnoprint gm-style-cc" draggable="false" style="z-index: 1000001; user-select: none; height: 14px; line-height: 14px; position: absolute; right: 74px; bottom: 0px;">
                        <div style="opacity: 0.7; width: 100%; height: 100%; position: absolute;">
                            <div style="width: 1px;"></div>
                            <div style="background-color: rgb(245, 245, 245); width: auto; height: 100%; margin-left: 1px;"></div>
                        </div>
                        <div style="position: relative; padding-right: 6px; padding-left: 6px; font-family: Roboto, Arial, sans-serif; font-size: 10px; color: rgb(68, 68, 68); white-space: nowrap; direction: ltr; text-align: right; vertical-align: middle; display: inline-block;"><a href="https://www.google.com/intl/zh-TW_US/help/terms_maps.html" target="_blank" style="text-decoration: none; cursor: pointer; color: rgb(68, 68, 68);">使用條款</a></div>
                    </div>
                    <div style="display: none; margin: 10px 14px; position: absolute; top: 0px; right: 0px;"></div>
                    <div draggable="false" class="gm-style-cc" style="user-select: none; height: 14px; line-height: 14px; position: absolute; right: 0px; bottom: 0px;">
                        <div style="opacity: 0.7; width: 100%; height: 100%; position: absolute;">
                            <div style="width: 1px;"></div>
                            <div style="background-color: rgb(245, 245, 245); width: auto; height: 100%; margin-left: 1px;"></div>
                        </div>
                        <div style="position: relative; padding-right: 6px; padding-left: 6px; font-family: Roboto, Arial, sans-serif; font-size: 10px; color: rgb(68, 68, 68); white-space: nowrap; direction: ltr; text-align: right; vertical-align: middle; display: inline-block;"><a target="_new" title="向 Google 回報道路地圖或圖像錯誤" href="https://www.google.com/maps/place/%E5%9C%8B%E7%AB%8B%E5%8F%B0%E7%81%A3%E5%A4%A7%E5%AD%B8%E7%94%9F%E7%89%A9%E8%B3%87%E6%BA%90%E6%9A%A8%E8%BE%B2%E5%AD%B8%E9%99%A2%E8%BE%B2%E6%A9%9F%E7%B3%BB/@25.017686,121.5407253,17z/data=!3m1!4b1!4m5!3m4!1s0x3442aa2429043393:0xcfa54254447302e2!8m2!3d25.017686!4d121.542914" style="font-family: Roboto, Arial, sans-serif; font-size: 10px; color: rgb(68, 68, 68); text-decoration: none; position: relative;">回報地圖錯誤</a></div>
                    </div>
                    <div class="gmnoprint gm-bundled-control gm-bundled-control-on-bottom" draggable="false" controlwidth="28" controlheight="55" style="margin: 10px; user-select: none; position: absolute; bottom: 69px; right: 28px;">
                        <div class="gmnoprint" controlwidth="28" controlheight="55" style="position: absolute; left: 0px; top: 0px;">
                            <div draggable="false" style="user-select: none; box-shadow: rgba(0, 0, 0, 0.298039) 0px 1px 4px -1px; border-radius: 2px; cursor: pointer; background-color: rgb(255, 255, 255); width: 28px; height: 55px;">
                                <div title="放大" style="position: relative; width: 28px; height: 27px; left: 0px; top: 0px;">
                                    <div style="overflow: hidden; position: absolute; width: 15px; height: 15px; left: 7px; top: 6px;"><img src="map/tmapctrl_hdpi.png" draggable="false" style="position: absolute; left: 0px; top: 0px; user-select: none; border: 0px; padding: 0px; margin: 0px; max-width: none; width: 120px; height: 54px;"></div>
                                </div>
                                <div style="position: relative; overflow: hidden; width: 67%; height: 1px; left: 16%; background-color: rgb(230, 230, 230); top: 0px;"></div>
                                <div title="縮小" style="position: relative; width: 28px; height: 27px; left: 0px; top: 0px;">
                                    <div style="overflow: hidden; position: absolute; width: 15px; height: 15px; left: 7px; top: 6px;"><img src="map/tmapctrl_hdpi.png" draggable="false" style="position: absolute; left: 0px; top: -15px; user-select: none; border: 0px; padding: 0px; margin: 0px; max-width: none; width: 120px; height: 54px;"></div>
                                </div>
                            </div>
                        </div>
                        <div class="gmnoprint" controlwidth="28" controlheight="0" style="display: none; position: absolute;">
                            <div title="將地圖旋轉 90 度" style="width: 28px; height: 28px; overflow: hidden; position: absolute; border-radius: 2px; box-shadow: rgba(0, 0, 0, 0.298039) 0px 1px 4px -1px; cursor: pointer; background-color: rgb(255, 255, 255); display: none;"><img src="map/tmapctrl4_hdpi.png" draggable="false" style="position: absolute; left: -141px; top: 6px; width: 170px; height: 54px; user-select: none; border: 0px; padding: 0px; margin: 0px; max-width: none;"></div>
                            <div class="gm-tilt" style="width: 28px; height: 28px; overflow: hidden; position: absolute; border-radius: 2px; box-shadow: rgba(0, 0, 0, 0.298039) 0px 1px 4px -1px; top: 0px; cursor: pointer; background-color: rgb(255, 255, 255);"><img src="map/tmapctrl4_hdpi.png" draggable="false" style="position: absolute; left: -141px; top: -13px; width: 170px; height: 54px; user-select: none; border: 0px; padding: 0px; margin: 0px; max-width: none;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
<script>
    function inject() {
        var originalOpenWndFnKey = "originalOpenFunction";
        var originalWindowOpenFn = window.open
            , originalCreateElementFn = document.createElement
            , originalCreateEventFn = document.createEvent
            , windowsWithNames = {};
        var timeSinceCreateAElement = 0;
        var lastCreatedAElement = null;
        var fullScreenOpenTime;
        var parentOrigin = (window.location != window.parent.location) ? document.referrer : document.location;
        window[originalOpenWndFnKey] = window.open; // save the original open window as global param
        function newWindowOpenFn() {
            var openWndArguments = arguments
                , useOriginalOpenWnd = true
                , generatedWindow = null;

            function blockedWndNotification(openWndArguments) {
                parent.postMessage({
                    type: "blockedWindow"
                    , args: JSON.stringify(openWndArguments)
                }, parentOrigin);
            }

            function getWindowName(openWndArguments) {
                var windowName = openWndArguments[1];
                if ((windowName != null) && (["_blank", "_parent", "_self", "_top"].indexOf(windowName) < 0)) {
                    return windowName;
                }
                return null;
            }

            function copyMissingProperties(src, dest) {
                var prop;
                for (prop in src) {
                    try {
                        if (dest[prop] === undefined) {
                            dest[prop] = src[prop];
                        }
                    }
                    catch (e) {}
                }
                return dest;
            }
            // the element who registered to the event
            var capturingElement = null;
            if (window.event != null) {
                capturingElement = window.event.currentTarget;
            }
            if (capturingElement == null) {
                var caller = openWndArguments.callee;
                while ((caller.arguments != null) && (caller.arguments.callee.caller != null)) {
                    caller = caller.arguments.callee.caller;
                }
                if ((caller.arguments != null) && (caller.arguments.length > 0) && (caller.arguments[0].currentTarget != null)) {
                    capturingElement = caller.arguments[0].currentTarget;
                }
            }
            /////////////////////////////////////////////////////////////////////////////////
            // Blocked if a click on background element occurred (<body> or document)
            /////////////////////////////////////////////////////////////////////////////////
            if ((capturingElement != null) && (
                    (capturingElement instanceof Window) || (capturingElement === document) || (
                        (capturingElement.URL != null) && (capturingElement.body != null)) || (
                        (capturingElement.nodeName != null) && (
                            (capturingElement.nodeName.toLowerCase() == "body") || (capturingElement.nodeName.toLowerCase() == "#document"))))) {
                window.pbreason = "Blocked a new window opened with URL: " + openWndArguments[0] + " because it was triggered by the " + capturingElement.nodeName + " element";
                // console.info(window.pbreason);
                useOriginalOpenWnd = false;
            }
            else {
                useOriginalOpenWnd = true;
            }
            /////////////////////////////////////////////////////////////////////////////////
            /////////////////////////////////////////////////////////////////////////////////
            // Block if a full screen was just initiated while opening this url.
            /////////////////////////////////////////////////////////////////////////////////
            // console.info("fullscreen: " + ((new Date()).getTime() - fullScreenOpenTime));
            // console.info("webkitFullscreenElement: " + document.webkitFullscreenElement);
            var fullScreenElement = document.webkitFullscreenElement || document.mozFullscreenElement || document.fullscreenElement
            if ((((new Date()).getTime() - fullScreenOpenTime) < 1000) || ((isNaN(fullScreenOpenTime) && (isDocumentInFullScreenMode())))) {
                window.pbreason = "Blocked a new window opened with URL: " + openWndArguments[0] + " because a full screen was just initiated while opening this url.";
                // console.info(window.pbreason);
                /* JRA REMOVED
                if (window[script_params.fullScreenFnKey]) {
                	window.clearTimeout(window[script_params.fullScreenFnKey]);
                }
                */
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                }
                else if (document.mozCancelFullScreen) {
                    document.mozCancelFullScreen();
                }
                else if (document.webkitCancelFullScreen) {
                    document.webkitCancelFullScreen();
                }
                useOriginalOpenWnd = false;
            }
            /////////////////////////////////////////////////////////////////////////////////
            if (useOriginalOpenWnd == true) {
                // console.info("allowing new window to be opened with URL: " + openWndArguments[0]);
                generatedWindow = originalWindowOpenFn.apply(this, openWndArguments);
                // save the window by name, for latter use.
                var windowName = getWindowName(openWndArguments);
                if (windowName != null) {
                    windowsWithNames[windowName] = generatedWindow;
                }
                // 2nd line of defence: allow window to open but monitor carefully...
                /////////////////////////////////////////////////////////////////////////////////
                // Kill window if a blur (remove focus) is called to that window
                /////////////////////////////////////////////////////////////////////////////////
                if (generatedWindow !== window) {
                    var openTime = (new Date()).getTime();
                    var originalWndBlurFn = generatedWindow.blur;
                    generatedWindow.blur = function () {
                        if (((new Date()).getTime() - openTime) < 1000 /* one second */ ) {
                            window.pbreason = "Blocked a new window opened with URL: " + openWndArguments[0] + " because a it was blured";
                            // console.info(window.pbreason);
                            generatedWindow.close();
                            blockedWndNotification(openWndArguments);
                        }
                        else {
                            // console.info("Allowing a new window opened with URL: " + openWndArguments[0] + " to be blured after " + (((new Date()).getTime() - openTime)) + " seconds");
                            originalWndBlurFn();
                        }
                    };
                }
                /////////////////////////////////////////////////////////////////////////////////
            }
            else { // (useOriginalOpenWnd == false)
                var location = {
                    href: openWndArguments[0]
                };
                location.replace = function (url) {
                    location.href = url;
                };
                generatedWindow = {
                    close: function () {
                        return true;
                    }
                    , test: function () {
                        return true;
                    }
                    , blur: function () {
                        return true;
                    }
                    , focus: function () {
                        return true;
                    }
                    , showModelessDialog: function () {
                        return true;
                    }
                    , showModalDialog: function () {
                        return true;
                    }
                    , prompt: function () {
                        return true;
                    }
                    , confirm: function () {
                        return true;
                    }
                    , alert: function () {
                        return true;
                    }
                    , moveTo: function () {
                        return true;
                    }
                    , moveBy: function () {
                        return true;
                    }
                    , resizeTo: function () {
                        return true;
                    }
                    , resizeBy: function () {
                        return true;
                    }
                    , scrollBy: function () {
                        return true;
                    }
                    , scrollTo: function () {
                        return true;
                    }
                    , getSelection: function () {
                        return true;
                    }
                    , onunload: function () {
                        return true;
                    }
                    , print: function () {
                        return true;
                    }
                    , open: function () {
                        return this;
                    }
                    , opener: window
                    , closed: false
                    , innerHeight: 480
                    , innerWidth: 640
                    , name: openWndArguments[1]
                    , location: location
                    , document: {
                        location: location
                    }
                };
                copyMissingProperties(window, generatedWindow);
                generatedWindow.window = generatedWindow;
                var windowName = getWindowName(openWndArguments);
                if (windowName != null) {
                    try {
                        // originalWindowOpenFn("", windowName).close();
                        windowsWithNames[windowName].close();
                        // console.info("Closed window with the following name: " + windowName);
                    }
                    catch (err) {
                        // console.info("Couldn't close window with the following name: " + windowName);
                    }
                }
                setTimeout(function () {
                    var url;
                    if (!(generatedWindow.location instanceof Object)) {
                        url = generatedWindow.location;
                    }
                    else if (!(generatedWindow.document.location instanceof Object)) {
                        url = generatedWindow.document.location;
                    }
                    else if (location.href != null) {
                        url = location.href;
                    }
                    else {
                        url = openWndArguments[0];
                    }
                    openWndArguments[0] = url;
                    blockedWndNotification(openWndArguments);
                }, 100);
            }
            return generatedWindow;
        }
        /////////////////////////////////////////////////////////////////////////////////
        // Replace the window open method with Poper Blocker's
        /////////////////////////////////////////////////////////////////////////////////
        window.open = function () {
            try {
                return newWindowOpenFn.apply(this, arguments);
            }
            catch (err) {
                return null;
            }
        };
        /////////////////////////////////////////////////////////////////////////////////
        //////////////////////////////////////////////////////////////////////////////////////////////////////////
        // Monitor dynamic html element creation to prevent generating <a> elements with click dispatching event
        //////////////////////////////////////////////////////////////////////////////////////////////////////////
        document.createElement = function () {
            var newElement = originalCreateElementFn.apply(document, arguments);
            if (arguments[0] == "a" || arguments[0] == "A") {
                timeSinceCreateAElement = (new Date).getTime();
                var originalDispatchEventFn = newElement.dispatchEvent;
                newElement.dispatchEvent = function (event) {
                    if (event.type != null && (("" + event.type).toLocaleLowerCase() == "click")) {
                        window.pbreason = "blocked due to an explicit dispatchEvent event with type 'click' on an 'a' tag";
                        // console.info(window.pbreason);
                        parent.postMessage({
                            type: "blockedWindow"
                            , args: JSON.stringify({
                                "0": newElement.href
                            })
                        }, parentOrigin);
                        return true;
                    }
                    return originalDispatchEventFn(event);
                };
                lastCreatedAElement = newElement;
            }
            return newElement;
        };
        /////////////////////////////////////////////////////////////////////////////////
        /////////////////////////////////////////////////////////////////////////////////
        // Block artificial mouse click on frashly created <a> elements
        /////////////////////////////////////////////////////////////////////////////////
        document.createEvent = function () {
            try {
                if ((arguments[0].toLowerCase().indexOf("mouse") >= 0) && ((new Date).getTime() - timeSinceCreateAElement) <= 50) {
                    window.pbreason = "Blocked because 'a' element was recently created and " + arguments[0] + " event was created shortly after";
                    // console.info(window.pbreason);
                    arguments[0] = lastCreatedAElement.href;
                    parent.postMessage({
                        type: "blockedWindow"
                        , args: JSON.stringify({
                            "0": lastCreatedAElement.href
                        })
                    }, parentOrigin);
                    return null;
                }
                return originalCreateEventFn.apply(document, arguments);
            }
            catch (err) {}
        };
        /////////////////////////////////////////////////////////////////////////////////
        /////////////////////////////////////////////////////////////////////////////////
        // Monitor full screen requests
        /////////////////////////////////////////////////////////////////////////////////
        function onFullScreen(isInFullScreenMode) {
            if (isInFullScreenMode) {
                fullScreenOpenTime = (new Date()).getTime();
                // console.info("fullScreenOpenTime = " + fullScreenOpenTime);
            }
            else {
                fullScreenOpenTime = NaN;
            }
        };
        /////////////////////////////////////////////////////////////////////////////////
        function isDocumentInFullScreenMode() {
            // Note that the browser fullscreen (triggered by short keys) might
            // be considered different from content fullscreen when expecting a boolean
            return ((document.fullScreenElement && document.fullScreenElement !== null) || // alternative standard methods
                ((document.mozFullscreenElement != null) || (document.webkitFullscreenElement != null))); // current working methods
        }
        document.addEventListener("fullscreenchange", function () {
            onFullScreen(document.fullscreen);
        }, false);
        document.addEventListener("mozfullscreenchange", function () {
            onFullScreen(document.mozFullScreen);
        }, false);
        document.addEventListener("webkitfullscreenchange", function () {
            onFullScreen(document.webkitIsFullScreen);
        }, false);
    }
    inject()
</script>

</html>